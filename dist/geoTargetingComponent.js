!function(){"use strict";angular.module("geoTargetingModule",["yaMap"]).component("geoTargetingComponent",{bindings:{model:"=",options:"<"},template:'<div class="geo-targeting-component"><ya-map ya-after-init="$ctrl.getMap($target);" ya-zoom="$ctrl.options.zoom" ya-controls ya-center="$ctrl.options.coordinates" style="width: 600px; height: 600px; display: inline-block;"><ya-geo-object ya-after-init="$ctrl.getCircle($target);" ya-source="$ctrl.options.object" ya-options="{draggable: true, fillColor: \'#ffc53877\',strokeColor: \'#ffc538\',strokeOpacity: 0.8,strokeWidth: 1}"></ya-geo-object></ya-map></div>',controller:[function(){var e=this;e.circle={},e.map={},console.log(e.model),console.log(e.options),e.getCircle=function(t){e.circle=t,e.circle.events.add("dragend",function(t){e.tryFindAddrByCoords(e.circle.geometry.getCoordinates())})},e.getMap=function(t){e.map=t,e.map.events.add("click",function(t){var o=t.get("coords");e.circle.geometry.setCoordinates(o),e.tryFindAddrByCoords(o)}),e.existsAddress&&e.tryFindByAddr(e.existsAddress)},e.tryFindByAddr=function(t){ymaps.geocode(t,{results:1}).then(function(t){if(t){var o=t.geoObjects.get(0),r=o.geometry.getCoordinates();o.properties.get("boundedBy")&&(e.circle.geometry.setCoordinates(r),e.map.setCenter(r),e.tryFindAddrByCoords(r))}})},e.tryFindAddrByCoords=function(t){ymaps.geocode(t).then(function(o){var r=o.geoObjects.get(0);r.getAddressLine()&&($timeout(function(){e.currentAddress=r.getAddressLine()?r.getAddressLine():"Не удалось определить адрес."},0),e.circle.geometry.setCoordinates(t))})}}]})}();